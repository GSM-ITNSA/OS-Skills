## Load Balancing
### 부하 분산이란?
```
애플리케이션을 지원하는 리소스 풀 전체에 네트워크 트래픽을 균등하게 배포하는 방법입니다.

최신 애플리케이션은 수백만 명의 사용자를 동시에 처리하고 정확한 텍스트, 비디오, 이미지 및 기타 데이터를 빠르고 안정적인 방식으로 각 사용자에게 반환해야 합니다.

이렇게 많은 양의 트래픽을 처리하기 위해 대부분의 애플리케이션에는 데이터가 중복되는 리소스 서버가 많이 있습니다.

로드 밸런서는 사용자와 서버 그룹 사이에 위치하며 보이지 않는 촉진자 역할을 하여 모든 리소스 서버가 동일하게 사용되도록 하는 디바이스입니다.
```
### 로드 밸런싱의 종류
로드 밸런싱의 종류는 OSI 7계층에 따라 나뉩니다.

- L4 : Transport 계층을 사용, IP 주소와 포트 번호 부하 분산이 가능
- L7 : Application 계층을 사용, URL 또는 HTTP 헤더에서 부하 분산이 가능

```
먼저, 로드 밸런서는 몇 계층에서 분산작업을 수행하느냐에 따라 NLB(Network LoadBalancer)와 ALB (Aplication LoadBalancer)로 나눌 수 있습니다. 

기존에는 CLB(Classic LoadBalancer)라고 하는 여러 EC2 인스턴스간에 간단한 트래픽 부하 분산하는 로드 밸런서도 있었지만, 최근에는 잘 사용하지 않습니다
```

### NLB (Network Load Balancer)
```
주로 TCP 및 UDP 트래픽을 처리하며 간단한 로드 밸런싱 기능을 필요로 하는 경우에 사용되는 Layer 4 Load Balancer이다.

Target Group 대신에 Target IP로 표현되며, IP 주소 레벨에서 동작하기 때문에 IP 주소로 직접 서버를 대상으로 지정합니다.

예시:
    www.naver.com/mail 로 요청을 보낸다고 가정했을때, NLB는 L4 계층의 프로토콜까지 
    밖에 확인 못 하기 때문에 목적 IP 만 확인하고 맞는 대상으로 전달만 해준다.
    대신 알아야 하는 프로토콜이 적기 때문에 부하가 적다.
(Port 기반)
```

### ALB (Application Load Balancer)
```
주로 HTTP 및 HTTPS 트래픽을 처리하며, 웹 어플리케이션과 마이크로서비스 아키텍처에 특화된 고급 기능을 제공하는 Layer 7 Load Balancer 이다.

Target Group 을 사용하여 HTTP 및 HTTPS 요청을 받은 다음, 각 요청을 하나 이상의 인스턴스 또는 컨테이너로 전달합니다.

예시:
    www.naver.com/mail 로 요청을 보낸다고 가정했을때, ALB 는 L7 계층의 프로토콜까지 
    다 확인하기 때문에 목적지까지 알맞게 요청을 보낼 수 있다.
    정확한 만큼 아는 프로토콜이 많기 때문에 부하가 생길 수 있다.
(URI 기반)
```

### 로드 밸런싱 알고리즘이란?
```
트래픽이나 작업을 여러 서버에 분산시키는 방식을 결정하는 규칙 또는 메커니즘을 나타냅니다.

각 알고리즘은 서버의 상태, 트래픽 패턴, 또는 사용자 요청에 대한 다양한 요소들을 고려하여 효과적으로 로드를 분산합니다

```
다양한 로드 밸런싱 알고리즘 중 몇 가지 대표적인 것들은 다음과 같습니다.
- 라운드 로빈 (Round Robin)
    - 요청을 순서대로 각 서버에게 전달
    - 서버의 수만큼 돌면 다시 처음부터 시작
    - 간단하고 모든 서버에게 고르게 트래픽을 분산시키지만, 각 서버의 성능이 다를 때는 효과적

- 가중치 기반 로드 밸런싱 (Weighted Round Robin)
    - 각 서버에 가중치를 할당
    - 가중치에 따라 요청을 분배하는 방식
    - 가중치가 높은 서버에는 더 많은 트래픽이 전달되도록 조절 할 수 있다.

- 최소 연결 수 (Minimum Connections)
    - 현재 연결 수가 가장 적은 서버에 요청을 전달
    - 서버의 현재 부하를 고려하여 트래픽을 분배

- 최소 응답 시간 (Minimum Response Time)
    - 각 서버의 응답 시간을 측정
    - 가장 빠른 응답 시간을 가진 서버에게 요청을 보냄

- IP 해시 (IP Hash)
    - 클라이언트의 IP 주소나 세션 정보를 해싱하여 얻은 결과값에 따라 특정 서버로 요청을 보내는 방식
    - 동일한 클라이언트가 항상 같은 서버에 연결되도록 보장